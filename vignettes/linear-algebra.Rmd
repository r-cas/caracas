---
title: "Linear algebra in `caracas`"
author: Mikkel Meyer Andersen and Søren Højsgaard
date: "`r date()`"
output: 
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 3
    number_sections: true
vignette: >
  %\VignetteIndexEntry{Linear algebra in `caracas`}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

```{r, message=FALSE, echo=FALSE}
library(caracas)
##packageVersion("caracas")
```

```{r, include = FALSE}
inline_code <- function(x) {
  x
}

if (!has_sympy()) {
  # SymPy not available, so the chunks shall not be evaluated
  knitr::opts_chunk$set(eval = FALSE)
  
  inline_code <- inline_code <- function(x) {
    deparse(substitute(x))
  }
}
```

This vignette is based on `caracas` version `r packageVersion("caracas")`. `caracas` is avavailable on CRAN at [https://cran.r-project.org/package=caracas] and on github at
[https://github.com/r-cas/caracas].

# Elementary matrix operations



## Creating matrices / vectors

```{r}
A <- matrix(c("a", "b", "0", "1"), 2, 2) %>% as_sym()
A

A2 <- matrix(c("a", "b", "c", "1"), 2, 2) %>% as_sym()
A2

B <- matrix(c("a", "b", "0", 
              "c", "c", "a"), 2, 3) %>% as_sym()
B

b <- matrix(c("b1", "b2"), nrow=2) %>% as_sym()
```

Note that a vector is a matrix in which one of the dimensions is one. 


## Addition / multiplication of matrices / vectors

## Matrix-matrix sum and product; 
```{r}
A + A2
A %*% B
```

## Hadamard (elementwise) product
```{r}
A * A2 
```

## Matrix inverse; solve system of linear equations

Solve $Ax=b$ for $x$:

```{r}
inv(A)
x <- solve_lin(A, b)
x
A %*% x ## Sanity check
```

## Generalized inverse; left and right inverse [TBW]


# More special linear algebra functionality


`getLA` short for "get Linear Algebra"
```{r}
args(getLA)
```


## QR decomposition

```{r}
A <- matrix(c("a", "0", "0", "1"), 2, 2) %>% as_sym()
A
qr_res <- getLA(A, "QRdecomposition")
qr_res$Q
qr_res$R
```

## Eigenvectors and eigenvalues

```{r}
getLA(A, "eigenvec")
getLA(A, "eigenvals")
eigenvec(A) ## Convenience function
eigenval(A) ## Convenience function
```


```{r}
A <- matrix(c("a", "b", "0", "1"), 2, 2) %>% as_sym()
A
```

## Inverse

```{r}
getLA(A, "inv")
inv(A)  ## Convenience function
```

## Characteristic polynomium

```{r}
getLA(A, "charpoly") ## Strange output
```

## Rank

```{r}
getLA(A, "rank")
```

## Cofactor

```{r}
getLA(A, "cofactor", 0, 1)
getLA(A, "cofactor_matrix")
```

## Echelon form

```{r}
getLA(A, "echelon_form")
```

## Cholesky factorisation [FIXME]

```{r}
#AH <- matrix(c("a^2", 0, 0, "b^2"), nrow=2) %>% as_sym()
#XSgetLA(AH, "cholesky")
```

## Gram Schmidt [FIXME]

```{r}
##getLA(A, "GramSchmidt") ## FIXME duer ikke.
```


## rref (reduced row-echelon form)[FIXME]

```{r}
##getLA(A, "rref") ## A warning 
```
